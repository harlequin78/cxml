<?xml version="1.0" encoding="iso-8859-1"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
  <head>
    <title>Closure XML</title>
    <style type="text/css">
      body { 
        color: #000000;
        background-color: #ffffff;
        margin-bottom: 10%;
      }
      pre {
        background-color: #eeeeee;
        border: solid 1px #d0d0d0;
        padding: 1em;
        margin-right: 10%;
      }
    </style>
  </head>
  <body>
    <h1>Closure XML Parser</h1>

    <p>An XML parser written in Common Lisp.</p>

    <p>
      Closure XML was written by <a
      href="http://www.stud.uni-karlsruhe.de/~unk6/">Gilbert Baumann</a>
      (unk6 at rz.uni-karlsruhe.de) as part of the Closure web
      browser.<br>
      Contributions to the parser by
      <ul>
        <li>
          Henrik Motakef (hmot at henrik-motakef.de)<br>
          (SAX layer; namespace support)
        </li>
        <li>
          David Lichteblau at knowledgeTools (david at knowledgetools.de)<br>
          (conversion into an independent package; DOM bug fixing)
        </li>
      </ul>
    </p>

    <p>
      <h2>CXML Modules</h2>

      CXML provides three packages:
      <ul>
        <li>
          <tt>RUNES</tt>, a portable implementation of Unicode strings.
        </li>
        <li>
          <tt>XML</tt>, a namespace-aware SAX parser implementing the <a
          href="http://www.w3.org/TR/2000/REC-xml-20001006">XML 1.0
          specification</a>.
        </li> 
        <li>
          <tt>DOM</tt>, an implementation of the <a
          href="http://www.w3.org/TR/REC-DOM-Level-1/level-one-core.html">DOM
          Level 1 Core</a> interfaces.
        </li> 
      </ul>
    </p>

    <p>
      <h2>Installation</h2>

      CXML is written in Common Lisp and should be portable to all
      Common Lisp implementations.&nbsp; Currently known to work are
      ACL, SBCL, CMUCL, and CLISP.  (<i>fixme</i>: check this list)
    </p>
    </p>
      <a href="http://www.cliki.net/asdf">ASDF</a> is used for
      compilation.  These instructions assume that ASDF has already been
      loaded.
    </p>

    <p>
      <b>Configuration (optional).</b>
      CXML has full Unicode code support -- even on Lisps without
      Unicode strings.  On non-unicode aware Lisps, <tt>DOMString</tt>
      is implemented as an array of character codes.  If your Lisp
      supports 16 bit characters natively, you can enable feature
      <tt>RUNE-IS-CHARACTER</tt> to select an alternative
      <tt>DOMString</tt> implementatation, which uses real characters
      instead of characters codes.
      <pre>* (pushnew :rune-is-character *features*)</pre>
    </p>

    <p>
      <b>Compiling and loading CXML.</b>
      Register the .asd file, e.g. by symlinking it:
      <pre>$ ln -sf `pwd`/cxms.asd /path/to/your/registry</pre>
      Then compile CXML using:
      <pre>* (asdf:operate 'asdf:load-op :cxml)</pre>
    </p>

    <p>
      <h2>Tests</h2>

      Check out the XML and DOM testsuites:
      <pre>$ export CVSROOT=:pserver:anonymous@dev.w3.org:/sources/public
$ cvs login    # password is "anonymous"
$ cvs co 2001/XML-Test-Suite/xmlconf
$ cvs co 2001/DOM-Test-Suite</pre>
      Usage and expected output:
      <pre>* (xmlconf:run-all-tests "/path/to/2001/XML-Test-Suite/xmlconf/")
22/389 tests failed; 1773 tests were skipped
* (domtest:run-all-tests "/path/to/2001/2001/DOM-Test-Suite/")
0/440 tests failed; 81 tests were skipped</pre>
    <p>

    <p>
      Most XML testsuite failures are due to document type declarations
      which are read by CXML, but not written when the document is
      serialized again.&nbsp; This needs work.
    </p>

    </p>
      <i>fixme</i>: Add an explanation of xml/sax-tests here.
    </p>

    <p>
      <h3>fixme</h3> My parser does not understand the current testsuite
      anymore.&nbsp; To fix this problem, revert the affected files
      manually after check-out:

      <pre>$ cd 2001/XML-Test-Suite/xmlconf/
xmltest$ patch -p0 -R &lt;/path/to/cxml/test/xmlconf-base.diff</pre>

      The log message for the changes reads "<i>Removed unnecessary
      xml:base attribute</i>".&nbsp; If I understand correctly, only
      DOM&nbsp;3 parsers provide the baseURI attribute necessary for
      understanding <tt>xmlconf.xml</tt> now.&nbsp; We don't have that
      yet.
    </p>
  </body>
</html>
